parameters:
  rust_version: stable

steps:
  - template: "deps-common.yml"

  - script: |
      for /f "tokens=*" %%i in ('vswhere -latest -products * -requires Microsoft.VisualStudio.Component.VC.Tools.x86.x64 -property installationPath') do set msbuildpath="%%i"
      echo "##vso[task.setvariable variable=msbuildpath]%msbuildpath%"
      %vcvarspath%\VC\Auxiliary\Build\vcvars64.bat
      cd wxWidgets\build\msw
      nmake.exe /f makefile.vc BUILD=release TARGET_CPU=X64
    displayName: "Compile wxWidgets"